!function(){"use strict";angular.module("TwoCentzWeb",["algoliasearch","ngCookies","ngResource","ngMessages","ngAnimate","toastr","ui.router","ngSanitize","mgcrea.ngStrap","mgcrea.ngStrap.modal","mgcrea.ngStrap.aside","stormpath","stormpath.templates","angular-jqcloud","LocalStorageModule","formly","formlyBootstrap","ngFileUpload","cloudinary"]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function(e,t,o,r){o.html5Mode(!0);e.state("home",{url:"/",templateUrl:"html/home.html",controller:"HomeCtrl"}).state("movies",{url:"/movies/:slug",templateUrl:"html/movies.html",controller:"MovieCtrl"}).state("usertopic",{url:"/user/:username/:slug",templateUrl:"html/userTopic.html",controller:"UserTopicCtrl"}).state("login",{url:"/login",templateUrl:"html/login.html",controller:"LoginCtrl"}).state("add",{url:"/add",templateUrl:"html/add.html",controller:"AddCtrl",sp:{authenticate:!0}}).state("mytopics",{url:"/mytopics",templateUrl:"html/mytopics.html",controller:"MyTopicsCtrl",sp:{authenticate:!0}}).state("signup",{url:"/signup",templateUrl:"html/signup.html",controller:"SignupCtrl"}).state("profile",{url:"/profile",templateUrl:"html/profile.html",controller:"ProfileCtrl",sp:{authenticate:!0}}).state("verify",{url:"/emailVerification?sptoken",templateUrl:"html/emailVerification.html",controller:"VerifyCtrl"}).state("passwordResetRequest",{url:"/password/requestReset?sptoken",templateUrl:"html/passwordResetRequest.html",controller:"ResetCtrl"}).state("reset",{url:"/password/reset?sptoken",templateUrl:"html/passwordReset.html",controller:"ResetCtrl"});t.otherwise("/");o.html5Mode(!0);o.hashPrefix("!")}]).run(["$stormpath",function(e){e.uiRouter({loginState:"login",defaultPostLoginState:"home"})}])}();!function(){"use strict";$.cloudinary.config().cloud_name="twocentz";$.cloudinary.config().upload_preset="uwkaxglj";angular.module("TwoCentzWeb").config(["$httpProvider",function(e){e.interceptors.push(function(){return{request:function(e){e.withCredentials=!1;return e}}})}])}();!function(){"use strict";angular.module("TwoCentzWeb").config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|whatsapp):/)}])}();!function(){"use strict";function e(e){var t=e;return encodeURIComponent(t).replace(/'/g,"%27").replace(/"/g,"%22")}function t(e){var t=e;return decodeURIComponent(t.replace(/\+/g," "))}angular.module("TwoCentzWeb").constant("moment",moment).constant("encode",e).constant("decode",t)}();angular.module("TwoCentzWeb").config(["formlyConfigProvider",function(e){var t=1;e.setType({name:"propertySection",templateUrl:"html/propertySection.html",controller:["$scope",function(e){function o(e){e=angular.copy(e);n(e);return e}function r(){e.model[e.options.key]=e.model[e.options.key]||[];var t=e.model[e.options.key];var o=t[t.length-1];var r={};o&&(r=angular.copy(o));t.push(r)}function n(e){t++;angular.forEach(e,function(e,o){if(e.fieldGroup)n(e.fieldGroup);else{e.templateOptions&&e.templateOptions.fields&&n(e.templateOptions.fields);e.id=e.id||e.key+"_"+o+"_"+t+i(0,9999)}})}function i(e,t){return Math.floor(Math.random()*(t-e))+e}e.formOptions={formState:e.formState};e.addNew=r;e.copyFields=o}]})}]);!function(){"use strict";angular.module("TwoCentzWeb").config(["localStorageServiceProvider",function(e){e.setPrefix("TwoCentzWeb").setStorageType("sessionStorage")}])}();!function(){"use strict";angular.module("TwoCentzWeb").directive("bsHolder",function(){return{link:function(e,t,o){Holder.run(t)}}})}();!function(){"use strict";function e(){function e(e,t,o){function r(e,t){var o="";_.each(e,function(e){o+=' "'+e.text+'"';return o.length>=t?!1:void 0});return o}var n=e.topic;if(e.topic._highlightResult){e.title=n._highlightResult.title.value;e.image=n.mediaFiles[0].url;e.release=n._highlightResult.props.releaseDate.value;e.slug=n.slug;e.genre=n._highlightResult.props.genre.value;e.entries=r(n.topEntries,50)}else{e.title=n.title;e.image=n.mediaFiles[0].url;e.release=n.props.releaseDate;e.slug=n.slug;e.genre=n.props.genre}}var t={restrict:"EA",link:e,scope:{topic:"="},templateUrl:"html/movieWidget.html"};return t}angular.module("TwoCentzWeb").directive("tcMovieWidget",e)}();!function(){"use strict";function e(e,t){function o(o,r,n){rrssbInit();o.$watch("media",function(r,n){var i="https://twocentz-ui-stage.herokuapp.com/";if(r){o.url=i+o.type+"/"+o.slug;"user"===o.type?o.img="https://res.cloudinary.com/twocentz/image/upload/a_auto/"+o.media[0].public_id:o.img=o.media[0].url;o.title=e(o.title);o.desc=e(t.getTopEntriesString(o.entries,50));$("head").append('<meta property="og:title" content="'+o.title+'" />');$("head").append('<meta property="og:url" content="'+o.url+'" />');$("head").append('<meta property="og:image" content="'+o.img+'" />');$("head").append('<meta property="og:description" content="'+o.desc+'" />')}})}var r={restrict:"EA",link:o,scope:{slug:"@",media:"=",entries:"=",title:"@",type:"@"},templateUrl:"html/socialShare.html"};return r}angular.module("TwoCentzWeb").directive("tcSocialShare",e);e.$inject=["encode","HelperService"]}();!function(){"use strict";function e(){function e(e,t,o){e.textField=[];e.textArea=[];e.$watch("category",function(t,o){if(t&&"USERS"===e.category){e.props.hasOwnProperty("textField")&&(e.textField=e.props.textField);e.props.hasOwnProperty("textArea")&&(e.textArea=e.props.textArea)}})}var t={restrict:"EA",link:e,scope:{props:"=",category:"="},templateUrl:"html/topicDetails.html"};return t}angular.module("TwoCentzWeb").directive("tcTopicDetails",e)}();!function(){"use strict";function e(){function e(e,o,r){var n=e.topic;e.title=n.title;n.mediaFiles&&n.mediaFiles.length>0?e.image=n.mediaFiles[0].public_id:e.image=null;e.slug=n.slug;e.userName=n.userName;e.entries=t(n.topEntries,50)}function t(e,t){var o="";_.each(e,function(e){o+=' "'+e.text+'"';return o.length>=t?!1:void 0});return o}var o={restrict:"EA",link:e,scope:{topic:"="},templateUrl:"html/topicWidget.html"};return o}angular.module("TwoCentzWeb").directive("tcTopicWidget",e)}();!function(){"use strict";function e(e,t,o,r,n,i,l,s){function a(){var t=JSON.parse(angular.toJson(u.model));e.files&&e.uploadFile().then(function(e){var o=[e.data];t.mediaFiles=o;s.postUserTopic(t).then(function(e){e.userName?r.transitionTo("usertopic",{username:e.userName,slug:e.slug}):e.exists&&l.error("title already exist, try another name.","Error")})},function(e){l.error("uploading image file failed","Error")})}function c(){u.model={};u.fields=[{key:"title",type:"input",templateOptions:{label:"Title",placeholder:"your topics title",required:!0}},{key:"description",type:"textarea",templateOptions:{label:"Description",placeholder:"Some description of the topic"}},{type:"propertySection",key:"textArea",templateOptions:{btnText:"new text area",fields:[{className:"form-inline",fieldGroup:[{type:"input",key:"fieldName",templateOptions:{label:"Label",placeholder:"your field label",required:!0}},{type:"textarea",key:"fieldValue",templateOptions:{label:"Value",placeholder:"your field value",required:!0,rows:4,cols:20}}]}]}}]}document.title="Add a new topic - TwoCentz";var u=this;u.onSubmit=a;u.options={};c();u.originalFields=angular.copy(u.fields);e.setFiles=function(t){e.files=t};e.uploadFile=function(){var t=n.defer();var o,r;e.files||t.reject("error");r=e.files[0];r&&!r.$error&&(o=i.upload({url:"https://api.cloudinary.com/v1_1/"+$.cloudinary.config().cloud_name+"/upload",fields:{upload_preset:$.cloudinary.config().upload_preset,context:"alt="+e.title},file:r}).progress(function(e){r.progress=Math.round(100*e.loaded/e.total);r.status="Uploading... "+r.progress+"%"}).error(function(e,o,n,i){r.result=e;t.reject("error")}));o.then(function(e){t.resolve(e)});return t.promise};e.dragOverClass=function(e){var t=e.dataTransfer.items;var o=!1;if(null!=t){for(var r=0;r<t.length;r++)if("file"==t[r].kind){o=!0;break}}else o=!0;return o?"dragover":"dragover-err"}}angular.module("TwoCentzWeb").controller("AddCtrl",e);e.$inject=["$scope","$rootScope","$alert","$state","$q","Upload","toastr","Topic"]}();!function(){"use strict";angular.module("TwoCentzWeb").controller("VerifyCtrl",["$scope","Auth",function(e,t){document.title="Verify email - TwoCentz";e.verify=function(){t.verify({name:e.displayName,email:e.email,password:e.password})};e.pageClass="fadeZoom"}])}();!function(){"use strict";function e(e,t,o,r){function n(t){o.search(t).then(function(t){e.topics=t},function(e){console.log(e)})}function i(){n(t().format("MMMM YYYY"))}document.title="TwoCentz - topics, reviews, opinions";e.search=n;i()}angular.module("TwoCentzWeb").controller("HomeCtrl",e);e.$inject=["$scope","moment","SearchService","Topic"]}();!function(){"use strict";function e(e){document.title="User Login - TwoCentz"}angular.module("TwoCentzWeb").controller("LoginCtrl",e);e.$inject=["$scope"]}();!function(){"use strict";function e(e,t,o,r,n,i,l,s){function a(t){var o=r.defer();if(!_.isEmpty(t)&&!e.tc.submited){e.tc.submited=!0;i.postMovieEntriesByTopicId(t,e.topic.id).then(function(r){if("true"===r.created){s.addEntryToLocalCache(t,e.topic.topEntries,e.userVoted);e.topic.topEntries=s.descSort(e.topic.topEntries);e.words=s.populateWordCloud(e.topic.topEntries)}o.resolve(r);e.tc.submited=!1})}return o.promise}e.error=!1;e.colors=["#ddd","#ccc","#bbb","#aaa","#999","#888","#777","#666","#555","#444","#333","#222"];n.getMovieBySlug(o.slug).then(function(r){if(r.error){e.error=!0;e.errorMessage="Couldn't find information for movie '"+o.slug+"'"}else{e.topic=r;e.words=s.populateWordCloud(e.topic.topEntries);e.userVoted=[];document.title=e.topic.title+" - TwoCentz";t.get().then(function(){l.getUserEntriesByTopicId(e.topic.id).then(function(t){t.error?toastr.error("Couldn't fetch user entries.","Warning"):e.userVoted=_.pluck(t.content,"text")})})["catch"](function(){})}});e.tc={text:"",submited:!1};e.list={text:"show all",text_all:"show all",text_less:"show less",limit:5,"default":5,max:100,isMax:!1};e.keySubmit=function(t){13===t.which&&e.postTwoCentz()};e.upVote=function(e){a(e)};e.isVoted=function(t){return _.indexOf(e.userVoted,t)>-1?!0:!1};e.postTwoCentz=function(){a(e.tc.text).then(function(t){"true"===t.created?$(".label-success").show().addClass("animated pulse").delay(2e3).fadeOut(1e3):$(".label-danger").show().addClass("animated shake").delay(2e3).fadeOut(1e3);e.tc.text=""})};e.toggleEntries=function(){if(e.isMax){e.list.limit=e.list["default"];e.list.text=e.list.text_all;e.isMax=!1}else{e.list.limit=e.list.max;e.list.text=e.list.text_less;e.isMax=!0}}}angular.module("TwoCentzWeb").controller("MovieCtrl",e);e.$inject=["$scope","$user","$stateParams","$q","Topic","Entries","User","HelperService"]}();!function(){"use strict";function e(e,t){function o(){return t.getAllUserTopics().then(function(t){e.topics=t.content;return e.topics})}function r(){return o().then(function(){})}document.title="TwoCentz - My Topics";r()}angular.module("TwoCentzWeb").controller("MyTopicsCtrl",e);e.$inject=["$scope","Topic"]}();!function(){"use strict";function e(e,t){var o=t({scope:e,template:"html/asideNavbar.html",show:!1});e.showMenu=function(){o.$promise.then(function(){o.show()})}}angular.module("TwoCentzWeb").controller("NavbarCtrl",e);e.$inject=["$scope","$aside"]}();!function(){"use strict";angular.module("TwoCentzWeb").controller("ResetCtrl",["$scope",function(e){document.title="Reset password - TwoCentz"}])}();!function(){"use strict";function e(e,t,o){document.title="User profile - TwoCentz"}angular.module("TwoCentzWeb").controller("ProfileCtrl",e);e.$inject=["$scope","$stateParams","Topic"]}();!function(){"use strict";function e(e){document.title="Sign-up to TwoCentz"}angular.module("TwoCentzWeb").controller("SignupCtrl",e);e.$inject=["$scope"]}();!function(){"use strict";function e(e,t,o,r,n,i,l,s,a,c){function u(t){var o=r.defer();if(!_.isEmpty(t)&&!e.tc.submited){e.tc.submited=!0;l.postUserTopicEntriesByTopicId(t,e.topic.id).then(function(r){if("true"===r.created){c.addEntryToLocalCache(t,e.topic.topEntries,e.userVoted);e.topic.topEntries=c.descSort(e.topic.topEntries);e.words=c.populateWordCloud(e.topic.topEntries)}o.resolve(r);e.tc.submited=!1})}return o.promise}e.error=!1;e.colors=["#ddd","#ccc","#bbb","#aaa","#999","#888","#777","#666","#555","#444","#333","#222"];e.showModal=function(){var t=n({scope:e,template:"html/topicImage.html",show:!1});t.$promise.then(function(){t.show()})};i.getUserTopicBySlug(o.username,o.slug).then(function(r){if(r.error){e.error=!0;e.errorMessage="Couldn't find information for topic '"+o.slug+"''"}else if(0===r.content.length){e.error=!0;e.errorMessage="Couldn't find information for topic '"+o.slug+"''"}else{e.topic=r.content[0];e.words=c.populateWordCloud(e.topic.topEntries);e.userVoted=[];document.title=e.topic.title+" - TwoCentz";t.get().then(function(){a.getUserEntriesByTopicId(e.topic.id).then(function(t){t.error?s.error("Couldn't fetch user entries.","Warning"):e.userVoted=_.pluck(t.content,"text")})})["catch"](function(){})}});e.tc={text:"",submited:!1};e.list={text:"show all",text_all:"show all",text_less:"show less",limit:5,"default":5,max:100,isMax:!1};e.keySubmit=function(t){13===t.which&&e.postTwoCentz()};e.upVote=function(e){u(e)};e.isVoted=function(t){return _.indexOf(e.userVoted,t)>-1?!0:!1};e.postTwoCentz=function(){u(e.tc.text).then(function(t){"true"===t.created?$(".label-success").show().addClass("animated pulse").delay(2e3).fadeOut(1e3):$(".label-danger").show().addClass("animated shake").delay(2e3).fadeOut(1e3);e.tc.text=""})};e.toggleEntries=function(){if(e.isMax){e.list.limit=e.list["default"];e.list.text=e.list.text_all;e.isMax=!1}else{e.list.limit=e.list.max;e.list.text=e.list.text_less;e.isMax=!0}}}angular.module("TwoCentzWeb").controller("UserTopicCtrl",e);e.$inject=["$scope","$user","$stateParams","$q","$modal","Topic","Entries","toastr","User","HelperService"]}();!function(){"use strict";angular.module("TwoCentzWeb").filter("fromNow",function(){return function(e){return moment(e).fromNow()}})}();!function(){"use strict";function e(e,t,o,r){function n(r){var n=t.defer();var i=o.get(r);i&&a()?n.resolve(i):e.get(r).then(function(e){o.set(r,e.data);n.resolve(e.data)},function(e){n.resolve(e.data)});return n.promise}function i(o,r){var n=t.defer();e.post(o,r).then(function(e){n.resolve(e.data)},function(e){n.resolve(e.data)});return n.promise}function l(e){return o.remove(e)}function s(){return o.clearAll()}function a(){var e,t,n="false";e=o.get("useCache");t=r.getUrlParam("useCache");t?n=t:e&&(n=e);o.set("useCache",n);return"true"===n?!0:!1}var c={getValue:n,postValue:i,deleteValue:l,clearAll:s};return c}angular.module("TwoCentzWeb").factory("CachedDataService",e);e.$inject=["$http","$q","localStorageService","HelperService"]}();!function(){"use strict";function e(e){function t(t){e.getValue("/api/movies/entries/"+t)}function o(t,o){var r={text:t,topicId:o};return e.postValue("api/entries/movies",r)}function r(t,o){var r={text:t,topicId:o};return e.postValue("api/entries/usertopics",r)}var n={getMovieEntryById:t,postMovieEntriesByTopicId:o,postUserTopicEntriesByTopicId:r};return n}angular.module("TwoCentzWeb").factory("Entries",e);e.$inject=["CachedDataService"]}();!function(){"use strict";function e(){function e(e){var t=[];_.each(e,function(e){t.push({text:e.text,weight:e.votes})});return t}function t(e){return _.sortBy(e,function(e){return-1*e.votes})}function o(e,t,o){var r=_.findIndex(t,function(t){return t.text==e});if(-1!==r){if(-1===_.indexOf(o,e)){t[r].votes=t[r].votes+1;o.push(e)}}else{t.push({text:e,votes:1});o.push(e)}}function r(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function n(e,t){var o="";_.each(e,function(e){o+=' "'+e.text+'"';return o.length>=t?!1:void 0});return o}var i={descSort:t,populateWordCloud:e,addEntryToLocalCache:o,getUrlParam:r,getTopEntriesString:n};return i}angular.module("TwoCentzWeb").factory("HelperService",e)}();!function(){"use strict";function e(e,t){function o(t){var o=e.defer();r().search(t).then(function(e){o.resolve(e.hits)},function(e){o.reject(e)});return o.promise}function r(){var e="05FTLLM54V";var o="657c40e74e8a05261076878c1d08d093";var r="twocentz_movies";var n=t.Client(e,o);return n.initIndex(r)}var n={search:o};return n}angular.module("TwoCentzWeb").factory("SearchService",e);e.$inject=["$q","algolia"]}();!function(){"use strict";function e(e){function t(){return e.getValue("/api/topics")}function o(t){return e.getValue("/api/topics/s/"+t)}function r(t){return e.getValue("/api/movies/s/"+t)}function n(t,o){return e.getValue("api/topics/users/"+t+"/"+o)}function i(){return e.getValue("api/usertopics")}function l(t){var o=_.merge({},_.pick(t,"textArea"),_.pick(t,"textField"));var r={title:t.title,description:t.description,props:o,mediaFiles:t.mediaFiles};return e.postValue("api/topics/users",r)}var s={getAll:t,getTopicBySlug:o,getMovieBySlug:r,postUserTopic:l,getUserTopicBySlug:n,getAllUserTopics:i};return s}angular.module("TwoCentzWeb").factory("Topic",e);e.$inject=["CachedDataService"]}();!function(){"use strict";function e(e){function t(){return e.getValue("/api/user/entries")}function o(t){return e.getValue("/api/user/entries/"+t)}var r={getAllUserEntries:t,getUserEntriesByTopicId:o};return r}angular.module("TwoCentzWeb").factory("User",e);e.$inject=["CachedDataService"]}();
//# sourceMappingURL=app.min.js.map